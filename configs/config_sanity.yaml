# ============================================================================
# SANITY CHECK CONFIGURATION (BLACK-SCHOLES REPLICATION)
# ============================================================================

experiment_name: "sanity_check_bs"  # Nom différent pour ne pas écraser tes vrais tests

caching:
  enabled: true
  directory: "./cache_sanity"  
  mode: "on"

checkpointing:
  enabled: true
  directory: "./checkpoints"
  save_freq: 10
  keep_last: 1

data:
  heston:
    S_0: 100.0
    K: 100.0
    r: 0.02
    mu: 0.02
    v_0: 0.04
    kappa: 1.5768
    theta: 0.04  # <--- LONG-TERM VARIANCE EGALE A L'INITIALE : BS CASE
    xi: 0.0000000001       # <--- VOLATILITE DE LA VARIANCE PRESQUE NULLE : BS CASE
    rho: -0.5711
  
  n_train: 100000    
  n_val: 15000
  n_test: 15000
  T: 0.0833
  n_steps: 30
  dt: 0.002777
  
  transaction_cost:
    c_prop: 0.0     # <--- ZERO COUTS : C'est la clé du sanity check
    
  seeds:
    train: 100
    val: 101
    test: 102

model:
  input_dim: 5
  recurrent_dim: 3
  hidden_dims: [64, 64, 32]  # Petit modèle pour aller très vite
  dropout_rates: [0.0, 0.0, 0.0]
  use_batch_norm: false
  activation: "relu"

training:
  optimizer_name: "adam"
  learning_rate: 0.005   # Taux d'apprentissage un peu plus élevé
  weight_decay: 0.0001
  epochs: 300        # 300 epochs suffisent largement
  batch_size: 8192    # Grand batch size pour accélérer l'entraînement
  
  loss_type: "entropic"
  risk_aversion: 1.0
  cvar_alpha: 0.05
  
  patience: 30
  min_delta: 0.000001
  clip_grad_norm: 1.0
  
  lr_scheduler: "cosine"
  lr_step_size: 50
  lr_gamma: 0.5

# Pas besoin des sections pruning/attacks pour ce test simple
pruning:
  sparsities: []
  target_sparsity: 0.0
  method: "magnitude"
  iterative: false
  num_iterations: 0
  exclude_output: true
  pruning_lr: 0.0
  retrain_lr: 0.0
  retrain_epochs: 0

attacks:
  fgsm: {epsilon_S: 0.0}
  pgd: {epsilon_S: 0.0}
  stress: {epsilon_S: 0.0}

adversarial_training:
  phase1: {epochs: 0}
  phase2: {epochs: 0}

regime_shifts:
  calm: {theta: 0.04}
  high_vol: {theta: 0.09}
  extreme: {theta: 0.16}

evaluation:
  metrics:
    - mean_pnl
    - std_pnl
    - sharpe_ratio
    - cvar_005
    - hedging_error_rmse
  n_bootstrap: 100

logging:
  use_tensorboard: false
  tensorboard_dir: "./runs_sanity"
  print_freq: 10
  save_figures: true
  figures_dir: "./figures_sanity"

compute:
  device: "auto"
  num_workers: 0
  pin_memory: true